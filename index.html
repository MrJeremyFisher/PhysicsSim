<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="stylesheet.css">
	<script src="node_modules/evaluatex/dist/evaluatex.min.js"></script>

	<link rel="stylesheet" href="MathQuill\mathquill.css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
	<script src="MathQuill\mathquill.js"></script>
	<script>
		var MQ = MathQuill.getInterface(2);
	</script>
	<script src="keyboard.js"></script>

	<title>
		ISS Tracker
	</title>


</head>

<body>

	<div class="items">
		<div class="tile">

			<h1 id="velocity">`v~=`<span id="velocitySpan"></span>`{km}/h`</h1>
		</div>

		<div class="tile">
			<h1 id="altitude" title="Above sea level"><span id="altitudeSpan" title="Above sea level"></span>`km`*</h1>
		</div>

		<div class="tile">
			<h1 id="mass" title="As of January 4th, 2023">`419,725kg`</h1>
		</div>

		<div class="tile">
			<h1 id="longitude"><span id="longitudeSpan"></span>`째`</h1>
		</div>

		<div class="tile">
			<h1 id="latitude"><span id="latitudeSpan"></span>`째`</h1>
		</div>

		<div class="tile">
			<h1 id="distfromyou"></h1>
		</div>
	</div>

	<div class="inputDiv" id="wrap">
		<!-- <input id="content" oninput="UpdateMath(this.value)">
		<button id="button" type="button" onclick="updateValue(content)">Evaluate</button>
		<div id="render"></div> -->


		<div class="container">
			<h1><span id="mathInput"></span></h1>
			<h1><span id="mathOutput">ttt</span></h1>
		</div>

		<textarea id="keyboard"></textarea>
	</div>

	<div class="graph">
		<iframe src="http://jeremy.favro.ca:8080/" class="responsive-iframe" frameBorder="0" scrolling="no"></iframe>
	</div>

	


	<script type="text/javascript">
		var velo
		var alti
		var long
		var lati



		var inputSpan = document.getElementById('mathInput');
		var outputSpan = document.getElementById('mathOutput');

		var inputMathField = MQ.MathField(inputSpan, {
			handlers: {
				edit: function () {
					var enteredMath = inputMathField.latex(); // Get entered math in LaTeX format
					checkAnswer(enteredMath);

				}
			}
		});

		async function checkAnswer(math) {
			if (math != '') {
				fn = evaluatex(math);
				result = fn(variables = { v: await getData('vel'), y: await getData('alt'), m: await getData('mass') });
				console.log(result)
				outputSpan.textContent = result;
			} else {
			}
		}


		function roundToTwo(num) {
			return +(Math.round(num + "e+2") + "e-2");
		}

		async function getData(type) {
			const response = await fetch('https://api.wheretheiss.at/v1/satellites/25544')
			const data = await response.json()

			var velo = data.velocity
			var alti = data.altitude
			var long = roundToTwo(data.longitude)
			var lati = roundToTwo(data.latitude)
			var mass = 419725
			switch (type) {
				case 'vel':
					document.getElementById("velocitySpan").innerHTML = `${Math.round(velo)}`;
					return (velo)
					break;
				case 'alt':
					document.getElementById("altitudeSpan").innerHTML = `${Math.round(alti)}`;
					return (alti)
					break;
				case 'lon':
					document.getElementById("longitudeSpan").innerHTML = long + "째";
					return (long)
					break;
				case 'lat':
					document.getElementById("latitudeSpan").innerHTML = lati + "째";
					return (lati)
					break;
				case 'mass':
					return (mass)
					break;
				case 'all':
					document.getElementById("velocitySpan").innerHTML = `${Math.round(velo)}`;
					document.getElementById("altitudeSpan").innerHTML = `${Math.round(alti)}`;
					document.getElementById("longitudeSpan").innerHTML = `${long}`;
					document.getElementById("latitudeSpan").innerHTML = `${lati}`;
					await MathJax.Hub.Typeset()
					break;
				default:
				// code block
			}


		}


	</script>

</body>